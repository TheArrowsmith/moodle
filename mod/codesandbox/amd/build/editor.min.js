define ("mod_codesandbox/editor",["jquery","core/ajax","core/notification","core/str"],function(a,b,c,d){"use strict";return{init:function(d,e,f,g){var h=null;a(document).ready(function(){var a=document.getElementById("code-editor");if(a){h=CodeMirror.fromTextArea(a,{mode:"python",theme:"monokai",lineNumbers:!0,indentUnit:4,lineWrapping:!0,autofocus:!0});var b=h.getValue().trim();!b&&e&&h.setValue(e)}}),a("#run-code").on("click",function(){if(h){var b=h.getValue();a("#loading-spinner").show(),a("#run-code").prop("disabled",!0),a(".output-section").text(""),a.ajax({url:f+"/execute",method:"POST",contentType:"application/json",data:JSON.stringify({code:b}),success:function(b){a("#stdout").text(b.stdout||"(no output)"),a("#stderr").text(b.stderr||"(no errors)"),b.stderr?a('a[href="#stderr-tab"]').tab("show"):a('a[href="#stdout-tab"]').tab("show")},error:function(a,b,d){var e="Error: ";a.responseJSON&&a.responseJSON.detail?e+=a.responseJSON.detail:e+=d||b||"Could not connect to execution service",c.alert("Execution Error",e)},complete:function(){a("#loading-spinner").hide(),a("#run-code").prop("disabled",!1)}})}}),a("#submit-code").on("click",function(){if(h){var e=h.getValue();a("#loading-spinner").show(),a("#submit-code").prop("disabled",!0);var f=b.call([{methodname:"mod_codesandbox_submit_code",args:{cmid:d,code:e}}]);f[0].done(function(b){b.success?(c.addNotification({message:"Code submitted successfully!",type:"success"}),b.results&&(i(b.results),a('a[href="#results-tab"]').tab("show"))):c.alert("Submission Error",b.error||"Failed to submit code")}).fail(function(a){c.exception(a)}).always(function(){a("#loading-spinner").hide(),a("#submit-code").prop("disabled",!1)})}}),a("#clear-output").on("click",function(){a(".output-section").text(""),a("#test-results").empty()});function i(b){var c=a("#test-results");if(c.empty(),void 0!==b.score){var d=(100*b.score).toFixed(1),e=b.score>=.8?"text-success":b.score>=.6?"text-warning":"text-danger";c.append('<div class="mb-3"><h4>Score: <span class="'+e+'">'+d+'%</span></h4><p>Tests passed: '+b.passed_tests+" / "+b.total_tests+"</p></div>")}if(b.results&&b.results.length>0){var f=a('<div class="test-result-list"></div>');b.results.forEach(function(b){var c=b.passed?"fa-check text-success":"fa-times text-danger",d=a('<div class="test-result-item mb-2"><i class="fa '+c+'"></i> <strong>'+b.test_name+"</strong></div>");!b.passed&&b.message&&d.append('<pre class="test-error-message">'+j(b.message)+"</pre>"),f.append(d)}),c.append(f)}}function j(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return a.replace(/[&<>"']/g,function(a){return b[a]})}}}});
//# sourceMappingURL=editor.min.js.map